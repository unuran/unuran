# $Id$
#############################################################################

[main]

[main - data:]

# method (for information only: the program scans the file name)
method: DGT

# type of generator (cont|discr)
type: discr

# which distributions should be used for testing
# finite probability vectors
distributions: type & T_fpv

# which uniform random number generator should be used for testing
# Mersenne Twister as URNG
urng: mt19937(5678)

[main - header:]

/* prototypes */

static int COMPARE_SAMPLE_SIZE = 500;
static int VIOLATE_SAMPLE_SIZE = 20;

UNUR_DISTR *get_distr_with_invalid_pv( void );
UNUR_DISTR *get_distr_with_pv( void );

#############################################################################

[new]

[new - invalid NULL ptr: 
   distr = NULL; ]

~( distr );
	--> expected_NULL --> UNUR_ERR_NULL

[new - invalid distribution type:
   distr = unur_distr_cont_new(); ]

~( distr );
	 --> expected_NULL --> UNUR_ERR_DISTR_INVALID

[new - data missing in distribution object:
   double fpar[1] = {0.5};
   distr = unur_distr_geometric(fpar,1);   /* no probability vector */ ]

~( distr );
	--> expected_NULL --> UNUR_ERR_DISTR_REQUIRED

#############################################################################

[set]

[set - invalid NULL ptr: 
   par = NULL; ]

~_variant(par,1);
	--> expected_setfailed --> UNUR_ERR_NULL

~_guidefactor(par,-1.);
	--> expected_setfailed --> UNUR_ERR_NULL

[set - invalid parameter object:
   distr = get_distr_with_pv();
   par = unur_dau_new(distr); ]

~_variant(par,10);
	--> expected_setfailed --> UNUR_ERR_PAR_INVALID

~_guidefactor(par,-1.);
	--> expected_setfailed --> UNUR_ERR_PAR_INVALID


[set - invalid parameters:
   distr = get_distr_with_pv();
   par = unur_dgt_new(distr); ]

~_variant(par,10);
	--> expected_setfailed --> UNUR_ERR_PAR_VARIANT

~_guidefactor(par,-1.);
	--> expected_setfailed --> UNUR_ERR_PAR_SET


#############################################################################

[chg]

#############################################################################

[init]

[init - invalid data:
   distr = get_distr_with_invalid_pv();
   par = unur_dgt_new(distr); ]

unur_init( par );
	--> expected_NULL --> UNUR_ERR_GEN_DATA

#############################################################################

[reinit]

[reinit - exist:
   distr = unur_distr_normal(NULL,0);
   par = unur_srou_new(distr);
   gen = unur_init( par ); <-- ! NULL ]

unur_reinit( gen );
	--> expected_reinit

#############################################################################

[sample]

[sample - compare:
   distr = get_distr_with_pv();
   par = NULL; ]

/* default algorithm */
par = unur_dgt_new(distr);
        -->compare_int_sequence_par_start

/* variant 1 */
par = unur_dgt_new(distr);
unur_dgt_set_variant(par,1);
        -->compare_int_sequence_par

/* variant 2 */
par = unur_dgt_new(distr);
unur_dgt_set_variant(par,2);
        -->compare_int_sequence_par

/* larger guide table size */
par = unur_dgt_new(distr);
unur_dgt_set_guidefactor(par,10);
        -->compare_int_sequence_par

/* smaller guide table size */
par = unur_dgt_new(distr);
unur_dgt_set_guidefactor(par,0.1);
        -->compare_int_sequence_par

/* sequential search */
par = unur_dgt_new(distr);
unur_dgt_set_guidefactor(par,0.);
        -->compare_int_sequence_par


#############################################################################

[validate]

[validate - chi2 test:]

	--> run_validate_chi2 {
		/* default algorithm */
		par = unur_dgt_new(distr); }

	--> run_validate_chi2 {
		/* variant 1 */
		par = unur_dgt_new(distr);
		unur_dgt_set_variant(par,1); }

	--> run_validate_chi2 {
		/* variant 2 */
		par = unur_dgt_new(distr);
		unur_dgt_set_variant(par,2); }

	--> run_validate_chi2 {
		/* larger guide table size */
		par = unur_dgt_new(distr);
		unur_dgt_set_guidefactor(par,10); }

	--> run_validate_chi2 {
		/* smaller guide table size */
		par = unur_dgt_new(distr);
		unur_dgt_set_guidefactor(par,0.1); }

/* sequential search very slow: no testing */


#############################################################################
#############################################################################

[verbatim]

UNUR_DISTR *get_distr_with_pv( void )
{
\#define PV_SIZE 200
  double prob[PV_SIZE];
  UNUR_DISTR *distr;
  int i;

  for (i=0; i<PV_SIZE; i++)
    prob[i] = prng_get_next(urng);

  distr = unur_distr_discr_new();
  unur_distr_discr_set_prob(distr,prob,PV_SIZE);

  return distr;

\#undef PV_SIZE
} /* end of get_distr_with_pv() */

/*---------------------------------------------------------------------------*/

UNUR_DISTR *get_distr_with_invalid_pv( void )
{
\#define PV_SIZE 10
  double prob[PV_SIZE];
  UNUR_DISTR *distr;
  int i;

  prob[0] = -1.;    /* invalid ! */

  for (i=1; i<PV_SIZE; i++)
    prob[i] = prng_get_next(urng);

  distr = unur_distr_discr_new();
  unur_distr_discr_set_prob(distr,prob,PV_SIZE);

  return distr;
  
\#undef PV_SIZE
} /* end of get_distr_with_invalid_pv() */

/*---------------------------------------------------------------------------*/

#############################################################################
