# $Id$
#############################################################################

[main]

[main - data:]

# method (for information only: the program scans the file name)
method: DISTR

# which uniform random number generator should be used for testing
# Mersenne Twister as URNG
urng: mt19937(7823)

[main - header:]

/* prototypes */

static int COMPARE_SAMPLE_SIZE = 500;
static int VIOLATE_SAMPLE_SIZE = 20;

double pdf(double x, UNUR_DISTR *distr);
double dpdf(double x, UNUR_DISTR *distr);
double cdf(double x, UNUR_DISTR *distr);

double pmf(int k, UNUR_DISTR *distr);
double icdf(int k, UNUR_DISTR *distr);

UNUR_DISTR *get_distr_with_pv( void );


#############################################################################

[new]

#############################################################################

[set]

[set - invalid NULL ptr: 
   distr = NULL; ]

unur_distr_set_name( distr, "nix" );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_pdf( distr, pdf );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_dpdf( distr, dpdf );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_cdf( distr, cdf );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_pdfparams( distr, NULL, 0 );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_domain( distr, 0., 1. );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_mode( distr, 0. );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_pdfarea( distr, 1. );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_set_prob( distr, NULL, 0 );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_set_pmf( distr, pmf );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_set_cdf( distr, icdf );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_set_pmfparams( distr, NULL, 0 );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_set_domain( distr, 0, 10 );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_set_mode( distr, 0 );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_set_pmfsum( distr, 1. );
        --> expected_setfailed --> UNUR_ERR_NULL

[set - invalid distribution type:
	distr = unur_distr_discr_new(); ]

unur_distr_cont_set_pdf( distr, pdf );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_set_dpdf( distr, dpdf );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_set_cdf( distr, cdf );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_set_pdfparams( distr, NULL, 0 );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_set_domain( distr, 0., 1. );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_set_mode( distr, 0. );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_set_pdfarea( distr, 1. );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

[set - invalid distribution type:
   distr = unur_distr_cont_new(); ]

unur_distr_discr_set_prob( distr, NULL, 0 );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID


[set - invalid distribution type:
   distr = unur_distr_cont_new(); ]

unur_distr_discr_set_pmf( distr, pmf );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_discr_set_cdf( distr, icdf );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_discr_set_pmfparams( distr, NULL, 0 );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_discr_set_domain( distr, 0, 10 );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_discr_set_mode( distr, 0 );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_discr_set_pmfsum( distr, 1. );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

[set - invalid NULL ptr: 
   distr = unur_distr_cont_new(); ]

unur_distr_cont_set_pdf( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_dpdf( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_cdf( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_set_pdfparams( distr, NULL, 1 );
        --> expected_setfailed --> UNUR_ERR_NULL

[set - invalid NULL ptr: 
   distr = unur_distr_discr_new(); ]

unur_distr_discr_set_pmf( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_set_cdf( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_set_pmfparams( distr, NULL, 1 );
        --> expected_setfailed --> UNUR_ERR_NULL

[set - invalid parameters: 
   double prob[] = {1.,2.,3.};
   distr = unur_distr_cont_new(); ]

unur_distr_cont_set_pdfparams( distr, prob, -1 );
        --> expected_setfailed --> UNUR_ERR_DISTR_NPARAMS

unur_distr_cont_set_pdfparams( distr, prob, UNUR_DISTR_MAXPARAMS +1 );
        --> expected_setfailed --> UNUR_ERR_DISTR_NPARAMS

unur_distr_cont_set_domain( distr, 0., -1. );
        --> expected_setfailed --> UNUR_ERR_DISTR_SET

unur_distr_cont_set_domain( distr, 0., 1. );
unur_distr_cont_set_domain( distr, 0., 2. );
        --> expected_setfailed --> UNUR_ERR_DISTR_SET

unur_distr_cont_set_pdfarea( distr, -1. );
        --> expected_setfailed --> UNUR_ERR_DISTR_SET

[set - invalid parameters: 
   double prob[] = {1.,2.,3.};
   distr = unur_distr_discr_new(); ]

unur_distr_discr_set_pmfparams( distr, prob, -1 );
        --> expected_setfailed --> UNUR_ERR_DISTR_NPARAMS

unur_distr_discr_set_pmfparams( distr, prob, UNUR_DISTR_MAXPARAMS +1 );
        --> expected_setfailed --> UNUR_ERR_DISTR_NPARAMS

unur_distr_discr_set_domain( distr, 10, 1 );
        --> expected_setfailed --> UNUR_ERR_DISTR_SET

unur_distr_discr_set_domain( distr, 1, 10 );
unur_distr_discr_set_domain( distr, 1, 20 );
        --> expected_setfailed --> UNUR_ERR_DISTR_SET

unur_distr_discr_set_pmfsum( distr, -1. );
        --> expected_setfailed --> UNUR_ERR_DISTR_SET


#############################################################################

[get]

[get - invalid NULL ptr: 
   double a, b;
   distr = NULL; ]

(void*) unur_distr_get_name( distr );
        --> expected_NULL --> UNUR_ERR_NULL

unur_distr_get_type( distr );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_is_cont( distr );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_is_discr( distr );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_get_pdf( distr );
        --> expected_NULL --> UNUR_ERR_NULL

unur_distr_cont_get_dpdf( distr );
        --> expected_NULL --> UNUR_ERR_NULL

unur_distr_cont_get_cdf( distr );
        --> expected_NULL --> UNUR_ERR_NULL

unur_distr_cont_get_pdfparams( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_get_domain( distr, &a, &b );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_get_mode( distr );
        --> expected_INFINITY --> UNUR_ERR_NULL

unur_distr_cont_get_pdfarea( distr );
        --> expected_INFINITY --> UNUR_ERR_NULL

unur_distr_discr_get_prob( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_get_pmf( distr );
        --> expected_NULL --> UNUR_ERR_NULL

unur_distr_discr_get_cdf( distr );
        --> expected_NULL --> UNUR_ERR_NULL

unur_distr_discr_get_pmfparams( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_get_pmfsum( distr );
        --> expected_INFINITY --> UNUR_ERR_NULL


[get - invalid distribution type:
   double a,b;
   distr = unur_distr_discr_new(); ]

unur_distr_cont_get_pdf( distr );
        --> expected_NULL --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_get_dpdf( distr );
        --> expected_NULL --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_get_cdf( distr );
        --> expected_NULL --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_get_pdfparams( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_get_domain( distr, &a, &b );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_get_mode( distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_get_pdfarea( distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_INVALID

[get - invalid distribution type:
   int ia, ib;
   distr = unur_distr_cont_new(); ]

unur_distr_discr_get_prob( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_discr_get_domain( distr, &ia, &ib );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID



[get - invalid distribution type:
   distr = unur_distr_cont_new(); ]

unur_distr_discr_get_pmf( distr );
        --> expected_NULL --> UNUR_ERR_DISTR_INVALID

unur_distr_discr_get_cdf( distr );
        --> expected_NULL --> UNUR_ERR_DISTR_INVALID

unur_distr_discr_get_pmfparams( distr, NULL );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_discr_get_pmfsum( distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_INVALID

[get - parameters not unknwon:
   distr = unur_distr_cont_new(); ]

unur_distr_cont_get_mode( distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_GET

unur_distr_cont_get_pdfarea( distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_GET

[get - parameters not unknwon:
   distr = unur_distr_discr_new(); ]

unur_distr_discr_get_pmfsum( distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_GET


#############################################################################

[chg]

[chg - invalid NULL ptr: 
   distr = NULL; ]

unur_distr_cont_upd_mode( distr );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_cont_upd_pdfarea( distr );
        --> expected_setfailed --> UNUR_ERR_NULL

unur_distr_discr_upd_pmfsum( distr );
        --> expected_setfailed --> UNUR_ERR_NULL

[chg - invalid distribution type:
   distr = unur_distr_discr_new(); ]

unur_distr_cont_upd_mode( distr );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

unur_distr_cont_upd_pdfarea( distr );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

[chg - invalid distribution type:
   distr = unur_distr_cont_new(); ]

unur_distr_discr_upd_pmfsum( distr );
        --> expected_setfailed --> UNUR_ERR_DISTR_INVALID

[chg - missing data:
   distr = unur_distr_cont_new(); ]

unur_distr_cont_upd_mode( distr );
        --> expected_setfailed --> UNUR_ERR_DISTR_GET

unur_distr_cont_upd_pdfarea( distr );
        --> expected_setfailed --> UNUR_ERR_DISTR_DATA

[chg - missing data:
   distr = unur_distr_discr_new(); ]

unur_distr_discr_upd_pmfsum( distr );
        --> expected_setfailed --> UNUR_ERR_DISTR_DATA

##############################################################################

[init]

#############################################################################

[reinit]

#############################################################################

[sample]

[sample - invalid NULL ptr: 
   distr = NULL; ]

unur_distr_cont_eval_pdf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_NULL

unur_distr_cont_eval_dpdf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_NULL

unur_distr_cont_eval_cdf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_NULL

unur_distr_discr_eval_pmf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_NULL

unur_distr_discr_eval_cdf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_NULL

[sample - missing data:
   distr = unur_distr_cont_new(); ]

unur_distr_cont_eval_pdf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_DATA

unur_distr_cont_eval_dpdf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_DATA

unur_distr_cont_eval_cdf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_DATA

[sample - missing data:
   distr = unur_distr_discr_new(); ]

unur_distr_discr_eval_pmf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_DATA

unur_distr_discr_eval_cdf( 1., distr );
        --> expected_INFINITY --> UNUR_ERR_DISTR_DATA



#############################################################################

[validate]

#############################################################################
#############################################################################

[verbatim]

double pdf(double x, UNUR_DISTR *distr) { return 1.; }
double dpdf(double x, UNUR_DISTR *distr) { return 1.; }
double cdf(double x, UNUR_DISTR *distr) { return 1.; }

double pmf(int k, UNUR_DISTR *distr) { return 1.; }
double icdf(int k, UNUR_DISTR *distr) { return 1.; }

UNUR_DISTR *get_distr_with_pv( void )
{
\#define PV_SIZE 200
  double prob[PV_SIZE];
  UNUR_DISTR *distr;
  int i;

  for (i=0; i<PV_SIZE; i++)
    prob[i] = prng_get_next(urng);

  distr = unur_distr_discr_new();
  unur_distr_discr_set_prob(distr,prob,PV_SIZE);

  return distr;

\#undef PV_SIZE
} /* end of get_distr_with_pv() */

#############################################################################
