# $Id$
#############################################################################

[main]

[main - data:]

# method (for information only: the program scans the file name)
method: EMPK

[main - header:]

/* prototypes */

static int COMPARE_SAMPLE_SIZE = 10000;
static int VIOLATE_SAMPLE_SIZE = 20;

UNUR_DISTR *get_distr_with_data( void );

#############################################################################

[new]

[new - invalid NULL ptr: 
   distr = NULL; ]

~( distr );
	--> expected_NULL --> UNUR_ERR_NULL

[new - invalid distribution type:
   distr = unur_distr_cont_new(); ]

~( distr );
	 --> expected_NULL --> UNUR_ERR_DISTR_INVALID

[new - data missing in distribution object:
   distr = unur_distr_cemp_new();   /* no data given */ ]

~( distr );
	--> expected_NULL --> UNUR_ERR_DISTR_REQUIRED

#############################################################################

[set]

[set - invalid NULL ptr: 
   par = NULL; ]

~_kernel(par,UNUR_DISTR_GAUSSIAN);
	--> expected_setfailed --> UNUR_ERR_NULL

~_kernelgen(par, NULL, 1., 1.);
	--> expected_setfailed --> UNUR_ERR_NULL

~_beta(par,1.);
	--> expected_setfailed --> UNUR_ERR_NULL

~_smoothing(par,1.);
	--> expected_setfailed --> UNUR_ERR_NULL

~_varcor(par,TRUE);
	--> expected_setfailed --> UNUR_ERR_NULL

~_positive(par,TRUE);
	--> expected_setfailed --> UNUR_ERR_NULL


[set - invalid parameter object:
   distr = unur_distr_normal(NULL,0);
   par = unur_cstd_new(distr); ]

~_kernel(par,UNUR_DISTR_GAUSSIAN);
	--> expected_setfailed --> UNUR_ERR_PAR_INVALID

~_kernelgen(par, NULL, 1., 1.);
	--> expected_setfailed --> UNUR_ERR_NULL

~_beta(par,1.);
	--> expected_setfailed --> UNUR_ERR_PAR_INVALID

~_smoothing(par,1.);
	--> expected_setfailed --> UNUR_ERR_PAR_INVALID

~_varcor(par,TRUE);
	--> expected_setfailed --> UNUR_ERR_PAR_INVALID

~_positive(par,TRUE);
	--> expected_setfailed --> UNUR_ERR_PAR_INVALID

free(par);

[set - invalid parameters:
   distr = get_distr_with_data();
   par = unur_empk_new(distr); ]

~_kernel(par,UNUR_DISTR_BETA);
	--> expected_setfailed --> UNUR_ERR_PAR_SET

~_kernelgen(par, NULL, -1., 1.);
	--> expected_setfailed --> UNUR_ERR_NULL

~_beta(par,-1.);
	--> expected_setfailed --> UNUR_ERR_PAR_SET

~_smoothing(par,-1.);
	--> expected_setfailed --> UNUR_ERR_PAR_SET

free(par);

#############################################################################

[get]

#############################################################################

[chg]

[chg - invalid generator object:
   distr = unur_distr_normal(NULL,0);
   par = unur_cstd_new(distr);
   gen = unur_init( par ); <-- ! NULL ]

~_smoothing(gen,1.);
	--> expected_setfailed --> UNUR_ERR_GEN_INVALID

~_varcor(gen,TRUE);
	--> expected_setfailed --> UNUR_ERR_GEN_INVALID

[chg - invalid parameters:
   distr = get_distr_with_data();
   par = unur_empk_new(distr);
   gen = unur_init( par ); <-- ! NULL ]

~_smoothing(gen,-1.);
	--> expected_setfailed --> UNUR_ERR_PAR_SET


#############################################################################

[init]

[init - invalid NULL ptr: 
   par = NULL; ]

unur_init( par );
	--> expected_NULL --> UNUR_ERR_NULL


[init - run init:
   distr = get_distr_with_data();
   par = unur_empk_new(distr);
   gen = unur_init( par ); <-- ! NULL ]

# this should be o.k.
	--> none --> 0x0u

#############################################################################

[reinit]

#############################################################################

[sample]

[sample - compare clone:
   UNUR_GEN *clone;
   distr = get_distr_with_data();
   par = unur_empk_new(distr);
   gen = unur_init( par ); <-- ! NULL ]

/* original generator object */
        -->compare_double_sequence_gen_start

/* clone */
clone = unur_gen_clone(gen);
unur_free(gen);
gen = clone;
        -->compare_double_sequence_gen


#############################################################################

[validate]

#############################################################################
#############################################################################

[verbatim]

/*---------------------------------------------------------------------------*/

UNUR_DISTR *get_distr_with_data( void )
{
\#define PV_SIZE 20
  double pv[PV_SIZE];
  UNUR_DISTR *distr;
  int i;

  for (i=0; i<PV_SIZE; i++)
    pv[i] = 10. * unur_urng_fish();

  distr = unur_distr_cemp_new();
  unur_distr_cemp_set_data(distr,pv,PV_SIZE);

  return distr;

\#undef PV_SIZE
} /* end of get_distr_with_data() */

/*---------------------------------------------------------------------------*/

#############################################################################
