# $Id$
#############################################################################

[main]

[main - data:]

# method
method: TDR

# type of generator (cont|discr)
type: cont

# which distributions should be used for testing
# T-concave distributions with c <= 0.
distributions: type & T_Tconcave, c_max >= 0.

# which uniform random number generator should be used for testing
# Mersenne Twister as URNG
urng: mt19937(9234)

[main - header:]

/* prototypes */
double pdf( double x, UNUR_DISTR *distr );

double pdf_bimodal( double x, UNUR_DISTR *distr );
double dpdf_bimodal( double x, UNUR_DISTR *distr );

double pdf_negative( double x, UNUR_DISTR *distr );
double dpdf_negative( double x, UNUR_DISTR *distr );

double pdf_partnegative( double x, UNUR_DISTR *distr );
double dpdf_partnegative( double x, UNUR_DISTR *distr );

static int COMPARE_SAMPLE_SIZE = 500;
static int VIOLATE_SAMPLE_SIZE = 20;

#############################################################################

[new]

#############################################################################

[set]

#############################################################################

[get]

#############################################################################

[chg]

#############################################################################

[init]

#############################################################################

[reinit]

#############################################################################

[sample]

[sample - compare:
   distr = unur_distr_normal(NULL,0); 
   par = NULL; ]

/* GW, c = 0 */
par = unur_tdr_new(distr);
unur_tdr_set_variant_gw(par);
unur_tdr_set_c(par,0);
        -->compare_double_sequence_par_start

/* GW, c = 0, verifying mode */
par = unur_tdr_new(distr);
unur_tdr_set_variant_gw(par);
unur_tdr_set_c(par,0);
unur_tdr_set_verify(par,1);
        -->compare_double_sequence_par

/* PS, c = 0 */
par = unur_tdr_new(distr);
unur_tdr_set_variant_ps(par);
unur_tdr_set_c(par,0);
        -->compare_double_sequence_par_start

/* PS, c = 0, verifying mode */
par = unur_tdr_new(distr);
unur_tdr_set_variant_ps(par);
unur_tdr_set_c(par,0);
unur_tdr_set_verify(par,1);
        -->compare_double_sequence_par

/* IA, c = 0 */
par = unur_tdr_new(distr);
unur_tdr_set_variant_ia(par);
unur_tdr_set_c(par,0);
        -->compare_double_sequence_par_start

/* IA, c = 0, verifying mode */
par = unur_tdr_new(distr);
unur_tdr_set_variant_ia(par);
unur_tdr_set_c(par,0);
unur_tdr_set_verify(par,1);
        -->compare_double_sequence_par


#############################################################################

[validate]

[validate - chi2 test:]

	--> run_validate_chi2 {
		/* c = 0 */
		par = unur_tdr_new(distr);
		unur_tdr_set_variant_gw(par);
		unur_tdr_set_c(par,0.);
		unur_tdr_set_max_intervals(par,100); }

	--> run_validate_chi2 {
		/* c = 0 */
		par = unur_tdr_new(distr);
		unur_tdr_set_variant_ps(par);
		unur_tdr_set_c(par,0.);
		unur_tdr_set_max_intervals(par,100); }

	--> run_validate_chi2 {
		/* c = 0 */
		par = unur_tdr_new(distr);
		unur_tdr_set_variant_ia(par);
		unur_tdr_set_c(par,0.);
		unur_tdr_set_max_intervals(par,100); }

#############################################################################
#############################################################################

[verbatim]

/* pdf of bimodal density */
double pdf_bimodal( double x, UNUR_DISTR *distr )
{ 
	return ( exp(-(x-1.)*(x-1.)) + exp(-(x+1.)*(x+1.)) );
}
double dpdf_bimodal( double x, UNUR_DISTR *distr )
{ 
	return ( -2. * (x-1.) * exp(-(x-1.)*(x-1.)) -2. * (x+1.) * exp(-(x+1.)*(x+1.)) );
}

/* pdf with negative value */
double pdf_negative( double x, UNUR_DISTR *distr )  { return (-x*x); }
double dpdf_negative( double x, UNUR_DISTR *distr ) { return (-2.*x); }

/* pdf with partial negative value */
double pdf_partnegative( double x, UNUR_DISTR *distr )  
{ 
	return ((x>-0.89 && x<0.89) ? -1.: exp(-x*x)); 
}
double dpdf_partnegative( double x, UNUR_DISTR *distr ) 
{
	return ((x>-0.89 && x<0.89) ?0.: -2.*x*exp(-x*x));
}

/* pdf of bimodal density */
double pdf( double x, UNUR_DISTR *distr )
{ 
	return exp(-x*x/2.);
} /* end of pdf */

#############################################################################
